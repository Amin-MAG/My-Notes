# Linux Commands

## Create link

```bash
ln -s /root/B/publicB.pem
```

## Kill a process on a port

```bash
sudo kill -9 $(sudo lsof -t -i:3000)
```

## List folders sizes

```bash
du -sh *
```

If you want to sort them, you can use the `sort` command.

```bash
du -hs * | sort -h
```

An alternative for the `du` is the `ncdu`:

```bash
ncdu
```

## Common tricks

To check if a bash script is correct or not without running it:

```bash
bash -n <script>
```

Use -p flag when you want to create nested folders. For example:

```bash
mkdir -p a/b/c/d/e/f/g
```

## Tree the folders 2 levels

```bash
tree -L 2 .
```

## Environment variables

Import environment variables from a file.

`set -a` causes variables defined from now on to be automatically exported. It's available in any Bourne-like shell. `.` is the standard and Bourne name for the `source` command so I prefer it for portability (`source` comes from `csh` and is now available in most modern Bourne-like shells including `bash` though (sometimes with a slightly different behavior)).

```bash
set -a
source ./tmp.txt
set +a
```

You can create a template file like bellow

```bash
Package: SPCU-Client
Version: $VERSION
Architecture: armhf
Maintainer: SPCUINC <Admin@spcuinc.com>
Description: A program managing IoT devices.
```

Then you can replace the environment variables to generate a new config file.

```bash
envsubst < "configs/control" > "build/spcu_client_1.0.0-1_armhf/DEBIAN/control"
```

# Tar

## Extracting `.tar` files

To extract a `tar.gz` file, use the --extract (`-x`) option and specify the archive file name after the f option:

```bash
tar -xf archive.tar.gz
```

The `-v` option will make the tar command more visible and print the names of the files being extracted on the terminal.

By default, tar will extract the archive contents in the current working directory. Use the `--directory` (`-C`) to extract archive files in a specific directory:

```bash
tar -xf archive.tar.gz -C /home/linuxize/files
```

When extracting files, you must provide their exact names including the path, as printed by `--list` (`-t`).

Extracting one or more directories from an archive is the same as extracting files:

```bash
tar -xf archive.tar.gz dir1 dir2Copy
```

# Cron

## Basic syntax

***Cron*** reads the configuration files for a list of commands to execute. The daemon uses a specific syntax to interpret the lines in the ***crontab*** configuration tables.

To be able to set up a cron job, we need to understand the basic elements that make up this syntax. The standard form for a crontab line is as follows:

```bash
a b c d e /directory/command output

# Another pattern naming
MIN HOUR DOM MON DOW CMD
# MIN	Minute field	0 to 59
# HOUR	Hour field	0 to 23
# DOM	Day of Month	1-31
# MON	Month field	1-12
# DOW	Day Of Week	0-6
# CMD	Command	Any command to be executed
```

1. The first five fields **`a b c d e`** specify the time/date and recurrence of the job. See the table for further information.  [https://phoenixnap.com/kb/set-up-cron-job-linux](https://phoenixnap.com/kb/set-up-cron-job-linux)

2. In the second section, the **`/directory/command`** specifies the location and script you want to run.

3. The final segment **`output`** is optional. It defines how the system notifies the user of the job completion.

For example, if I want to run the script `run.sh`:

```bash
# Open the configuration file
crontab -e

# Add the line to the file
# It will run the script each miniute
# The current path that runs the script is /home/<username>
# The third option is optional and gathers the output in a file
* * * * * /home/ubuntu/cron/run.sh /home/ubuntu/cron/
```

## Special characters

For efficiency, cron syntax also uses operators. Operators are special characters that perform operations on the provided values in the cron field.

- **An asterisk (*)** stands for all values. Use this operator to keep tasks running during all months, or all days of the week.
- **A comma (,)** specifies separate individual values.
- **A dash (–)** indicates a range of values.
- **A forward-slash (/)** is used to divide a value into steps. (*/2 would be every other value, */3 would be every third, */10 would be every tenth, etc.)

### Time Special values

[https://www.thegeekstuff.com/2009/06/15-practical-crontab-examples/](https://www.thegeekstuff.com/2009/06/15-practical-crontab-examples/)

```bash
# Keyword	Equivalent
# @yearly	0 0 1 1 *
# @daily	0 0 * * *
# @hourly	0 * * * *
# @reboot	Run at startup.
# For example
@yearly /home/ramesh/red-hat/bin/annual-maintenance
```

## Set Cron job for another user

```bash
crontab –u other_username –e
```

# Network

## Block a server

Sometimes you may need to block the connection with specific servers. The file `/etc/hosts` is the one gathering information. If you want to block a server you should add lines to this file.

```jsx
# First open the file
sudo vim /etc/hosts

# Then Add these lines
0.0.0.0   www.example.com
0.0.0.0   example.com
::0       www.example.com
::0       example.com
```

## Set static IP addresses

There are some interfaces. You can change each interface using this command:

```bash
ifconfig <interface> <IP_Address> netmask <Netmask> up
```

For example, it could be like this:

```bash
ifconfig wlan0 192.168.1.5 netmask 255.255.255.0 up
```

To set the default gateway IP:

```bash
route add default gw <IP_Address>
```