# Security

# Digital signature

## Purposes

1. Authentication: To prove that the message was created and sent by the claimed server.
2. Non-Repudiation: The sender can't deny having sent the message later on.
3. Integrity: To ensure that the message was not altered in transmission.

### Asymmetric cryptography

# Certificates

## Why use Certificates?

Assume we want to establish an encrypted connection between client and server. We need to have the same key on the client-side and server-side. But there is no way that we can create it directly.

### Encrypting messages

The solution is using a private and a public key. If you use the private key to encrypt, you can use the public key to decrypt. Vice versa, you can use the public key to encrypt, then you can decode using the private key.

When a client wants to connect to a server, first asks for a public key. The server will send its public key to the client. The client uses the key to encrypt its own key. So now we have The client key encrypted by the server's public key. The client will send this encrypted key to the server. For sniffing, you need the private key to decrypt while the server is the only one that has the key. So the server receives the encrypted client key, decrypts it using the private key. Now both the server and client have the same key. They can encrypt and decrypt messages to each other. As there is no way to access the client key by sniffing through this process, the communication remains safe.
So why do we use certificates?

### Why do we need certificates?

To be honest, there is a way for sniffing. What if a person intercepts the server and sends its own public key instead of the server public key? In this case, the person can decrypt to catch the client key by using the private key. (The key can be encrypted with the server public key and be sent)
To wrap up, we should make sure that we receive the response from the correct server.

The solution is using certificate authority which is a third party. The server sends the public key to the certificate authority and wants to sign it. The certificate authority will return a certificate. A certificate contains the domain, the server public key, and the signature. The signature itself is the server public key encrypted by the private key of the certificate authority.

The certificate authority also needs an intermediate certificate that is linked to the former certificate. As you see, there is a chain of certificates until we get to the root certificate. The root certificates are self-signed, and it is installed on Operating systems. So all the clients have those root certificates.

Before establishing any connection with the server, The server sends the certificate to the client. The client will see what certificate authority it is. Then By using the certificate authority public key, The client can encrypt the public key and check if it is equal to the signature. It Also can decrypt the signature and check if it is similar to the server public key or not. It is continuing until it gets to the root certificate, which the client trusts.